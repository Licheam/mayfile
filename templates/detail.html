<!doctype html>
<html lang="{{ strings.lang }}">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{{ item.title }}</title>
  <link rel="stylesheet" href="/assets/style.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/styles/github.min.css" />
</head>

<body>
  <main class="container">

    <div class="title-row">
      <h1>{{ item.title }}</h1>
      <a class="btn btn-secondary" href="/">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
          <path
            d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z" />
        </svg>
        {{ strings.detail_new_paste }}
      </a>
    </div>
    <div class="result-meta">
      <span>{{ strings.detail_expires_label }}：{{ expires_in }}</span>
      <span style="margin: 0 8px; color: #d7dbe1;">|</span>
      <span>{{ strings.label_language }}：<span id="language-label-val">{{ language_label }}</span></span>
    </div>
    <div class="detail-actions">
      <button class="btn btn-secondary" type="button" id="copy-btn" data-label="{{ strings.detail_copy }}"
        data-copied="{{ strings.detail_copy_done }}">
        {{ strings.detail_copy }}
      </button>
      <a class="btn btn-secondary" href="/r/{{ token }}">{{ strings.detail_raw }}</a>
    </div>
    <div class="code-wrapper">
      <div class="line-numbers" id="line-numbers"></div>
      <pre
        class="paste-content"><code id="paste-content" data-language="{{ item.language }}">{{ item.content }}</code></pre>
    </div>
  </main>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/highlight.min.js"></script>
  <script>
    const copyButton = document.getElementById("copy-btn");
    const content = document.getElementById("paste-content");
    const lineNumbers = document.getElementById("line-numbers");

    if (content) {
      const source = content.textContent || "";
      if (lineNumbers) {
        const linesCount = source.split(/\r\n|\r|\n/).length;
        let nums = "";
        for (let i = 1; i <= linesCount; i++) {
          nums += i + "\n";
        }
        lineNumbers.textContent = nums;
      }

      const language = content.dataset.language || "auto";
      if (window.hljs) {
        if (language === "auto") {
          const result = window.hljs.highlightAuto(source);
          content.innerHTML = result.value;
          content.classList.add("hljs");
          if (result.language) {
            const langLabel = document.getElementById("language-label-val");
            if (langLabel) {
              langLabel.textContent += " (" + result.language + ")";
            }
          }
        } else if (window.hljs.getLanguage(language)) {
          const result = window.hljs.highlight(source, { language });
          content.innerHTML = result.value;
          content.classList.add("hljs");
        } else {
          const result = window.hljs.highlightAuto(source);
          content.innerHTML = result.value;
          content.classList.add("hljs");
        }
      }
    }

    if (copyButton && content) {
      copyButton.addEventListener("click", async () => {
        const text = content.textContent || "";
        try {
          await navigator.clipboard.writeText(text);
          copyButton.textContent = copyButton.dataset.copied || copyButton.textContent;
          setTimeout(() => {
            copyButton.textContent = copyButton.dataset.label || copyButton.textContent;
          }, 1500);
        } catch {
          copyButton.textContent = copyButton.dataset.label || copyButton.textContent;
        }
      });
    }
  </script>
</body>

</html>